# DIL: ì´í™í‹°ë¸Œ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸

> ìŠ¤í„°ë””: ì›”ê°„ CS, https://github.com/monthly-cs/2024-05-effective-typescript  
> ì‘ì„±ì¼: 2024-06-06  
> ì‘ì„±ì: dusunax

---

## ì•„ì´í…œ 42: ëª¨ë¥´ëŠ” íƒ€ì…ì˜ ê°’ì—ëŠ” any ëŒ€ì‹  unknownì„ ì‚¬ìš©í•˜ê¸° Use unknown Instead of any for Values with an Unknown Type

### unknown

- í•¨ìˆ˜ì˜ ë°˜í™˜ê°’ê³¼ ê´€ë ¨ëœ í˜•íƒœ
- ë³€ìˆ˜ ì„ ì–¸ê³¼ ê´€ë ¨ëœ í˜•íƒœ
- ë‹¨ì–¸ë¬¸ê³¼ ê´€ë ¨ëœ í˜•íƒœ

### ì˜ˆì‹œ: parseYAML í•¨ìˆ˜

```tsx
function parseYAML(yaml: string): any {}

interface Book {
  name: string;
  author: string;
}
const book: Book = parseYAML(` // ë°˜í™˜ê°’ì„ ì›í•˜ëŠ” íƒ€ì…ìœ¼ë¡œ í• ë‹¹í•´ì„œ ì‚¬ìš© 
  name: Wuthering Heights
  author: Emily BrontÃ«
`); // any => Book

// í˜¸ì¶œí•œ ê³³ì—ì„œ íƒ€ì… ì„ ì–¸ì„ ìƒëµí•˜ê²Œ ë˜ë©´? book ë³€ìˆ˜ëŠ” ì•”ì‹œì ì¸ any íƒ€ì…ì´ ëœë‹¤.
// ëŸ°íƒ€ì„ ì˜¤ë¥˜ ë°œìƒ!!
const book = parseYAML(`
  name: Jane Eyre
  author: Charlotte BrontÃ«
`); // any
console.log(book.title); // No error, logs "undefined" at runtime
book("read"); // No error, throws "book is not a function" at runtime

// unknownì„ returní•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤ğŸ‘
// unknown ê·¸ëŒ€ë¡œ ê°’ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—, Bookìœ¼ë¡œ íƒ€ì… ë‹¨ì–¸ì„ í•´ì•¼ í•œë‹¤.
// ë‹¨ì–¸? ì• ì´ˆì— Book íƒ€ì…ì„ ê¸°ëŒ€í•˜ê³  í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•¨
function safeParseYAML(yaml: string): unknown {
  return parseYAML(yaml);
}
const book = safeParseYAML(`
  name: The Tenant of Wildfell Hall
  author: Anne BrontÃ«
`);
console.log(book.title);
//          ~~~~ 'book' is of type 'unknown'
book("read");
// Error: 'book' is of type 'unknown'
```

- ë¶€ë¶„ ì§‘í•©ì´ë©´ì„œ ìƒìœ„ ì§‘í•©ì´ ë˜ê¸° ë•Œë¬¸ì— anyëŠ” íƒ€ì… ì‹œìŠ¤í…œê³¼ ìƒì¶©ë˜ëŠ” ë©´ì´ ìˆë‹¤.
  - íƒ€ì… ì²´ì»¤ëŠ” ì§‘í•© ê¸°ë°˜ì´ê¸° ë•Œë¬¸ì— ë¬´ìš©ì§€ë¬¼ì´ ëœë‹¤.

### any & unknown & never

| íŠ¹ì§• / íƒ€ì… | ì–´ë–¤ íƒ€ì…ì´ë“  í• ë‹¹ ê°€ëŠ¥ | ì–´ë– í•œ íƒ€ì…ìœ¼ë¡œë„ í• ë‹¹ë¨            |
| ----------- | ----------------------- | ----------------------------------- |
| `any`       | O                       | O (ì˜ˆì™¸: `never`ì—ë§Œ í• ë‹¹ ë¶ˆê°€)     |
| `unknown`   | O                       | X (`unknown`ê³¼ `any`ì—ë§Œ í• ë‹¹ ê°€ëŠ¥) |
| `never`     | X                       | O                                   |

```tsx
let valueAny: any;
let valueUnknown: unknown;
let valueNever: never;

// ì–´ë–¤ íƒ€ì…ì´ë“  í• ë‹¹ ê°€ëŠ¥
// â­•ï¸ any
valueAny = 123; // O
valueAny = "string"; // O
valueAny = true; // O

// â­•ï¸ unknown
valueUnknown = 123; // O
valueUnknown = "string"; // O
valueUnknown = true; // O

// âŒ never
valueNever = 123; // X
valueNever = "string"; // X
valueNever = true; // X

// ì–´ë– í•œ íƒ€ì…ì—ë„ í• ë‹¹ë¨
let num: number;

num = valueAny; // O (ì˜ˆì™¸: `never`ì—ë§Œ í• ë‹¹ ë¶ˆê°€) // numì˜ íƒ€ì…ì€ number
num = valueUnknown; // X (numberì— unknownì„ í• ë‹¹í•  ìˆ˜ ì—†ë‹¤.) // numì˜ íƒ€ì…ì€ number
num = valueNever; // O (ì˜ˆì™¸ ì—†ìŒ) // numì˜ íƒ€ì…ì€ number
```

![image](https://github.com/dusunax/blog/assets/94776135/79d69e4d-23e6-46c3-94f1-c07652d7776e)

- ì–´ë–¤ íƒ€ì…ì—ë„ neverê°€ ë“¤ì–´ê°ˆ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ ì‹ ê¸°í•˜ë‹¤. (ì§‘í•© ê´€ì )

### ì˜ˆì‹œ: ë³€ìˆ˜ ì„ ì–¸

- ì–´ë– í•œ ê°’ì˜ íƒ€ì…ì„ ëª¨ë¥´ëŠ” ê²½ìš°, unknownì„ ì‚¬ìš©í•œë‹¤.

```tsx
// ë­ë“  ë“¤ì–´ê°. grab-bag
interface Feature {
  id?: string | number;
  geometry: Geometry;
  properties: unknown;
}

// ë°°ì—´ ìš”ì†Œì˜ íƒ€ì…ì„ ëª¨ë¥´ëŠ” ê²½ìš°
function isSmallArray(arr: readonly unknown[]): boolean {
  return arr.length < 10;
}

// ì–´ë–¤ ê°’ì´ ë“¤ì–´ì˜¬ ì§€ ëª¨ë¥´ëŠ” ê²½ìš°
function processValue(value: unknown) {
  if (value instanceof Date) {
    value;
    // ^? (parameter) value: Date
  }
}

// ì‚¬ìš©ì ì •ì˜ íƒ€ì… ê°€ë“œ: unknown ì¢íˆê¸°ìš©
function isBook(value: unknown): value is Book {
  return (
    typeof value === "object" &&
    value !== null &&
    "name" in value &&
    "author" in value
  );
}
function processValue(value: unknown) {
  if (isBook(value)) {
    // ì‚¬ìš©ì ì •ì˜ íƒ€ì… ê°€ë“œ!
    value;
    // ^? (parameter) value: Book
  }
}

// ì œë„ˆë¦­ì„ ì˜ëª» ì‚¬ìš©í•˜ì§€ ë§ê³ , unknownì„ ë°˜í™˜í•˜ì.
// ì•„ë˜ ì½”ë“œì˜ ì œë„ˆë¦­ì€ íƒ€ì… ë‹¨ì–¸ì´ë‚˜ ë§ˆì°¬ê°€ì§€ì˜ ê¸°ëŠ¥ì´ë‹¤.
function safeParseYAML<T>(yaml: string): T {
  return parseYAML(yaml);
}
```

### íƒ€ì… ìºìŠ¤íŒ… / ë‹¨ì–¸ë¬¸ ì‚¬ìš© ì‹œ

- ê¸°ëŠ¥ì ìœ¼ë¡œ ë™ì¼í•˜ë‹¤.
- ë‹¤ë§Œ ë‚˜ì¤‘ì— ë‹¨ì–¸ë¬¸ì„ ë¶„ë¦¬í•˜ëŠ” ë¦¬íŒ©í„°ë§ ë“±ì„ ê³ ë ¤í•˜ì—¬ unknown ì‚¬ìš©í•˜ê¸°

```tsx
declare const foo: Foo;
let barAny = foo as any as Bar; // âŒ
let barUnk = foo as unknown as Bar; // â­•ï¸
```

### unknownê³¼ ìœ ì‚¬í•œ íƒ€ì…: object ë˜ëŠ” {}

- ë²”ìœ„ê°€ ë„“ì§€ë§Œ, unknownë³´ë‹¤ëŠ” ì¢ë‹¤.
  - {}ëŠ” nullê³¼ undefinedë¥¼ ì œì™¸í•œ ëª¨ë“  ê°’ì„ í¬í•¨í•œë‹¤. (ë¹ˆ ê°ì²´ê°€ ì•„ë‹˜. íƒ€ì…ì„)
  - objectëŠ” ëª¨ë“  ë¹„ê¸°ë³¸í˜•(non-primitive) íƒ€ì…
    - ê°ì²´, ë°°ì—´ í¬í•¨

```tsx
type ABC = {};
const abc: ABC = "abc";

type DEF = object;
const def: DEF = ["def"];
```

- unknown íƒ€ì… ë„ì… ì „ì—ëŠ” {}ê°€ ì¼ë°˜ì ìœ¼ë¡œ ì“°ì˜€ë‹¤. ìµœê·¼ì—ëŠ” unknownì„ ì£¼ë¡œ ì‚¬ìš©í•˜ê³ , ì •ë§ nullê³¼ undefinedê°€ ì•„ë‹ ë•Œë§Œ {}ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

### Things to Remember

- The unknown type is a type-safe alternative to any. Use it when you know you have a value but do not know or do not care what its type is.
  - unknownì€ any ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”, ì•ˆì „í•œ íƒ€ì…ì´ë‹¤. ì–´ë–¤ ê°’ì˜ íƒ€ì…ì„ ì•Œì§€ëª»í•˜ë©´ unknownì„ ì‚¬ìš©í•œë‹¤.
- Use unknown to force your users to use a type assertion or other form of narrowing.
  - unknownì„ ì‚¬ìš©í•´ì„œ ì‚¬ìš©ìê°€ íƒ€ì… ë‹¨ì–¸ë¬¸ì´ë‚˜ íƒ€ì… ì²´í¬ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ê°•ì œí•  ìˆ˜ ìˆë‹¤.
- Avoid return-only type parameters, which can create a false sense of security.
  - íƒ€ì… ë‹¨ì–¸ì´ë‚˜ ë§ˆì°¬ê°€ì§€ì¸ ì œë„ˆë¦­ ì‚¬ìš© ì¡°ì‹¬ (ì•ˆì „í•œ íƒ€ì…ì´ë¼ê³  ì°©ê°í•  ìˆ˜ ìˆë‹¤.)
- Understand the difference between {}, object, and unknown.
  - {}, object, unknown íƒ€ì…ì˜ ì°¨ì´ì  ì•Œê¸°
