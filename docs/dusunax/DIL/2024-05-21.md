# DIL: ì´í™í‹°ë¸Œ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸

> ìŠ¤í„°ë””: ì›”ê°„ CS, https://github.com/monthly-cs/2024-05-effective-typescript  
> ì‘ì„±ì¼: 2024-05-21  
> ì‘ì„±ì: dusunax

---

## íƒ€ì…ìŠ¤í¬ë¦½íŠ¸

## ì•„ì´í…œ 19: ì¶”ë¡  ê°€ëŠ¥ íƒ€ì…ì„ ì‚¬ìš©í•´ ì¥í™©í•œ ì½”ë“œ ë°©ì§€í•˜ê¸° Avoid Cluttering Your Code with Inferable Types

### íƒ€ì… ì¶”ë¡ 

- ëª¨ë“  ë³€ìˆ˜ì— íƒ€ì… ì„ ì–¸í•˜ëŠ” ê²ƒì€ ë¹„ìƒì‚°ì  / ë¶ˆí•„ìš”

```tsx
// not good!
let x: number = 12;

// enough!
let x = 12;
```

- íƒ€ì… ì¶”ë¡ ì´ ëœë‹¤ë©´ ëª…ì‹œì  íƒ€ì… êµ¬ë¬¸ì€ í•„ìš”í•˜ì§€ ì•ŠìŒ (ì˜¤íˆë ¤ ë°©í•´)
- ë³µì¡í•œ ê°ì²´ ë˜ëŠ” í•¨ìˆ˜ì˜ ë°˜í™˜ íƒ€ì…ë„ ì¶”ë¡ í•  ìˆ˜ ìˆìŒ

```tsx
// ê°ì²´ ì¶”ë¡ 
const person = {
  name: "Sojourner Truth",
  born: {
    where: "Swartekill, NY",
    when: "c.1797",
  },
  died: {
    where: "Battle Creek, MI",
    when: "Nov. 26, 1883",
  },
};
// {
//   name: string;
//   born: {
//     where: string;
//     when: string;
//   };
//   died: {
//     where: string;
//     when: string;
//   }
// }

// í•¨ìˆ˜ì˜ ë°˜í™˜ íƒ€ì… ì¶”ë¡ 
function square(nums: number[]) {
  return nums.map((x) => x * x);
}
const squares = square([1, 2, 3, 4]);
//    ^? const squares: number[]
```

- ìœ ë‹› íƒ€ì… ì¶”ë¡  (ë³´ë‹¤ ì •í™•í•œ íƒ€ì… ì¶”ë¡ ì„ í†µí•´ íƒ€ì… ì˜¤ë¥˜ ë°©ì§€!)

  ![image](https://github.com/dusunax/blog/assets/94776135/1a487833-ab48-4f6c-9cd9-1645b1ce8d4a)

- êµ¬ì¡°ë¶„í•´ í• ë‹¹(ë¹„êµ¬ì¡°í™” í• ë‹¹)ì„ í†µí•´ ì§€ì—­ ë³€ìˆ˜ì˜ íƒ€ì…ì´ ì¶”ë¡ ë˜ë„ë¡ í•˜ì. (ëª…ì‹œì  íƒ€ì… ì„ ì–¸X)

```tsx
function logProduct(product: Product) {
  const id: number = product.id;
  // ~~ Type 'string' is not assignable to type 'number'
  const name: string = product.name;
  const price: number = product.price;
  console.log(id, name, price);
}

function logProduct(product: Product) {
  const { id, name, price } = product;
  console.log(id, name, price);
}
```

### ë§¤ê°œë³€ìˆ˜ íƒ€ì… ëª…ì‹œ

- íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ë§¤ê°œë³€ìˆ˜ì˜ ìµœì¢… ì‚¬ìš©ì²˜ê¹Œì§€ ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤
  - ë³€ìˆ˜ì˜ íƒ€ì…ì€ ì²˜ìŒ ë“±ì¥í•  ë•Œ ê²°ì •ëœë‹¤
  - í•¨ìˆ˜/ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ì— íƒ€ì… êµ¬ë¬¸ì„ í¬í•¨í•˜ê³ , í•¨ìˆ˜ ë‚´ì˜ ì§€ì—­ ë³€ìˆ˜ì—ëŠ” íƒ€ì… êµ¬ë¬¸ì„ ë„£ì§€ ì•Šê¸° (ì½ëŠ” ì‚¬ëŒì´ êµ¬í˜„ ë¡œì§ì— ì§‘ì¤‘í•  ìˆ˜ ìˆìŒ)
- ë§¤ê°œë³€ìˆ˜ ê¸°ë³¸ê°’ì´ ìˆëŠ” ê²½ìš°, íƒ€ì…ì„ ì¶”ë¡ í•œë‹¤

  ```tsx
  function parseNumber(str: string, base = 10) {
    //                              ^? (parameter) base: number
    // ...
  }
  ```

### íƒ€ì… ì •ë³´ê°€ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬

- íƒ€ì… ì§€ì›í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ `ì½œë°± í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ íƒ€ì…`ì€ ìë™ìœ¼ë¡œ ì¶”ë¡ ëœë‹¤(ë³´í†µ)

  ```tsx
  // Don't do this:
  app.get("/health", (request: express.Request, response: express.Response) => {
    response.send("OK");
  });

  // Do this:
  app.get("/health", (request, response) => {
    //                ^? (parameter) request: Request<...>
    response.send("OK");
    // ^? (parameter) response: Response<...>
  });
  ```

- ì˜ˆì‹œ

  ```tsx
  import _ from "lodash";

  interface FoodItem {
    icon: string;
    category: string;
    price: number;
  }

  const foodItems: FoodItem[] = [
    { icon: "ğŸ”", category: "Fast Food", price: 5000 },
    { icon: "ğŸ•", category: "Fast Food", price: 8000 },
    { icon: "ğŸ£", category: "Japanese", price: 12000 },
    { icon: "ğŸœ", category: "Japanese", price: 10000 },
    { icon: "ğŸ", category: "Italian", price: 15000 },
    { icon: "ğŸ¥—", category: "Healthy", price: 9000 },
  ];

  // Lodashì˜ groupByë¥¼ ì‚¬ìš©í•  ë•Œ ì½œë°± í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ íƒ€ì…ì´ ìë™ìœ¼ë¡œ ì¶”ë¡ ë¨
  const groupedByCategory = _.groupBy(foodItems, (item) => item.category);

  console.log(groupedByCategory);
  ```

### íƒ€ì…ì„ ëª…ì‹œí•˜ê³  ì‹¶ì€ ê²½ìš°: ê°ì²´ ë¦¬í„°ëŸ´ ì •ì˜

- ì •ì˜ì— íƒ€ì…ì„ ëª…ì‹œí•˜ë©´, excess property check(ì¶”ê°€ ì†ì„± ì²´í¬, ì‰ì—¬ ì†ì„± ì²´í¬)ê°€ ë™ì‘í•œë‹¤
  - ì„ íƒì  ì†ì„±ì´ ìˆëŠ” íƒ€ì…ì˜ ì˜¤íƒ€ ë“±ì˜ ì˜¤ë¥˜
  - ë³€ìˆ˜ê°€ ì‚¬ìš©ë˜ëŠ” ìˆœê°„ì´ ì•„ë‹Œ í• ë‹¹í•˜ëŠ” ì‹œì ì— ì˜¤ë¥˜ë¥¼ í‘œì‹œ

```tsx
const elmo: Product = {
  name: "Tickle Me Elmo",
  id: "048188 627152",
  price: 28.99,
};
```

### íƒ€ì…ì„ ëª…ì‹œí•˜ê³  ì‹¶ì€ ê²½ìš°: í•¨ìˆ˜ ë°˜í™˜ê°’

- íƒ€ì… ì¶”ë¡ ì´ ê°€ëŠ¥í• ì§€ë¼ë„, êµ¬í˜„ìƒì˜ ì˜¤ë¥˜ê°€ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ê³³ê¹Œì§€ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šê¸° ìœ„í•´ íƒ€ì… êµ¬ë¬¸ì„ ëª…ì‹œí•  ìˆ˜ ìˆë‹¤.
  - ì•„ë˜ Promise ì˜ˆì‹œ ì°¸ê³  (ì‹¤ì œë¡œëŠ” async/awaitì„ íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸°, ì•„ì´í…œ 25)

```tsx
const cache: { [ticker: string]: number } = {};
function getQuote(ticker: string) {
  if (ticker in cache) {
    return cache[ticker]; // êµ¬í˜„ ì˜¤ë¥˜: Promiseë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤!
  }
  return fetch(`https://quotes.example.com/?q=${ticker}`)
    .then((response) => response.json())
    .then((quote) => {
      cache[ticker] = quote;
      return quote as number;
    });
}

// í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ê³³ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤
getQuote("MSFT").then(considerBuying);
//               ~~~~ Property 'then' does not exist on type
//                    'number | Promise<number>'

// ì˜ë„ëœ ë°˜í™˜ íƒ€ì…ì„ ëª…ì‹œí•˜ì—¬ => ì—ëŸ¬ê°€ ë°œìƒí•œ ìœ„ì¹˜ë¥¼ ì •í™•íˆ í‘œê¸°í•˜ê¸°
const cache: { [ticker: string]: number } = {};
function getQuote(ticker: string): Promise<number> {
  if (ticker in cache) {
    return cache[ticker];
    // ~~~ Type 'number' is not assignable to type 'Promise<number>'
  }
  // ...
}
```

- ì¥ì 

  1. ì˜¤ë¥˜ì˜ ìœ„ì¹˜ë¥¼ ì œëŒ€ë¡œ í‘œì‹œí•œë‹¤
  2. í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ë¥¼ ë”ìš± ëª…í™•í•˜ê²Œ í•œë‹¤ (ì…/ì¶œë ¥ íƒ€ì… ëª…ì‹œ)
  3. ëª…ëª…ëœ íƒ€ì… ì‚¬ìš©í•˜ê¸°

  ```tsx
  interface Vector2D {
    x: number;
    y: number;
  }
  function add(a: Vector2D, b: Vector2D): Vector2D {
    return { x: a.x + b.x, y: a.y + b.y };
  }
  ```

### Things to Remember

- Avoid writing type annotations when TypeScript can infer the same type.
  - íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ê°€ íƒ€ì…ì„ ì¶”ë¡ í•  ìˆ˜ ìˆë‹¤ë©´, íƒ€ì… êµ¬ë¬¸ ì‘ì„±í•˜ì§€ ì•Šê¸°
- Ideal TypeScript code has type annotations in function/method signatures but not on local variables in their bodies.
  - í•¨ìˆ˜/ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ì— íƒ€ì… êµ¬ë¬¸ì„ ì‘ì„±í•˜ê³ , ë‚´ë¶€ ì§€ì—­ ë³€ìˆ˜ì—ëŠ” ì‘ì„±í•˜ì§€ ë§ì.
- Consider using explicit annotations for object literals to enable excess property checking and ensure errors are reported close to where they occur.
  - ê°ì²´ ë¦¬í„°ëŸ´ê³¼ í•¨ìˆ˜ ë°˜í™˜ì—ëŠ” íƒ€ì… ëª…ì‹œë¥¼ ê³ ë ¤í•˜ì.
  - ì¶”ê°€/ì‰ì—¬ ì†ì„± ì²´í¬ & ì—ëŸ¬ê°€ ë°œìƒí•œ ìœ„ì¹˜ì— í‘œì‹œë˜ë„ë¡ í•˜ê¸°
- Don't annotate function return types unless the function has multiple returns, is part of a public API, or you want it to return a named type.
  - ê³µê°œëœ API í•¨ìˆ˜ì´ê±°ë‚˜, ëª…ëª…ëœ íƒ€ì…ì´ í•„ìš”í•œ ê²½ìš°ë¥¼ ì œì™¸í•˜ê³  ë¦¬í„´ íƒ€ì…ì€ ëª…ì‹œí•˜ì§€ ì•Šì•„ë„ ë  ê²ƒ
    - ì•„ë§ˆë„ ì»¨ë²¤ì…˜ì— ë”°ë¥¼ ê²ƒ ê°™ë‹¤
